---
const themes = [
  { id: 'default', name: 'Warm', color: '#F59E0B' },
  { id: 'midnight', name: 'Midnight', color: '#3B82F6' },
  { id: 'forest', name: 'Forest', color: '#10B981' },
  { id: 'lavender', name: 'Lavender', color: '#A78BFA' },
  { id: 'light', name: 'Light', color: '#2563EB' },
];

const isProd = import.meta.env.PROD;
---

<div class:list={[
  "fixed bottom-6 right-6 z-50 flex gap-2 p-3 rounded-2xl bg-black/80 backdrop-blur border border-white/20",
  isProd && "hidden md:flex"
]}>
  {themes.map((theme) => (
    <button
      data-theme-select={theme.id}
      class="theme-btn w-10 h-10 rounded-full border-4 border-transparent hover:scale-110 transition-all"
      style={`background-color: ${theme.color}`}
      title={theme.name}
      aria-label={`Switch to ${theme.name} theme`}
    />
  ))}
</div>

<style>
  .theme-btn.active {
    border-color: white !important;
    transform: scale(1.15);
    box-shadow: 0 0 20px currentColor;
  }
</style>

<script is:inline>
  (function() {
    var buttons = document.querySelectorAll('[data-theme-select]');

    function setTheme(themeId) {
      // Update data-theme attribute
      if (themeId === 'default') {
        document.documentElement.removeAttribute('data-theme');
      } else {
        document.documentElement.setAttribute('data-theme', themeId);
      }

      // Update button states
      buttons.forEach(function(btn) {
        if (btn.getAttribute('data-theme-select') === themeId) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });

      // Save to localStorage
      localStorage.setItem('theme', themeId);

      console.log('Theme set to:', themeId);
    }

    // Load saved theme on init
    var savedTheme = localStorage.getItem('theme') || 'default';
    setTheme(savedTheme);

    // Add click handlers
    buttons.forEach(function(btn) {
      btn.addEventListener('click', function() {
        var theme = btn.getAttribute('data-theme-select');
        setTheme(theme);
      });
    });
  })();
</script>
